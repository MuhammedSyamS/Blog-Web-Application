
<% title = 'Edit Post' %>

<link
  href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
  rel="stylesheet"
/>
<link rel=stylesheet href="/css/admin_post_edit.css">

<div class="container py-5">
  <!-- Header -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h2 class="fw-bold mb-1">
        <i class="bi bi-pencil-square text-primary"></i> Edit Post
      </h2>
      <p class="text-muted mb-0">Make changes to your post and update it instantly.</p>
    </div>
    <a href="/admin/posts" class="btn btn-outline-secondary">
      <i class="bi bi-arrow-left-circle me-1"></i> Back to Posts
    </a>
  </div>

  <!-- Edit Form -->
  <div class="card border-0 shadow-lg rounded-4">
    <div class="card-body p-4">
      <form
        action="/admin/posts/<%= post._id %>?_method=PUT"
        method="POST"
        enctype="multipart/form-data"
      >
        <!-- Title -->
        <div class="mb-4">
          <label for="title" class="form-label fw-semibold">Post Title</label>
          <input
            type="text"
            id="title"
            name="title"
            class="form-control form-control-lg"
            placeholder="Enter your post title"
            value="<%= post.title %>"
            required
          />
        </div>

        <!-- Existing Images -->
        <% if (post.images && post.images.length > 0) { %>
        <div class="mb-4">
          <label class="form-label fw-semibold">Existing Images</label>
          <div class="d-flex flex-wrap gap-3">
            <% post.images.forEach(function(img) { %>
            <div
              class="border rounded p-2 text-center shadow-sm"
              style="width: 130px;"
            >
              <img
                src="/uploads/posts/<%= img %>"
                class="img-fluid rounded mb-2"
                alt="Existing image"
                style="height: 90px; object-fit: cover; width: 100%;"
              />
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  name="removeImages[]"
                  value="<%= img %>"
                  id="remove_<%= img %>"
                />
                <label
                  for="remove_<%= img %>"
                  class="form-check-label small text-muted"
                  >Remove</label
                >
              </div>
            </div>
            <% }) %>
          </div>
        </div>
        <% } %>

        <!-- Upload New Images -->
        <div class="mb-4">
          <label for="newImages" class="form-label fw-semibold">
            <i class="bi bi-upload me-1"></i> Upload New Images
          </label>
          <input
            type="file"
            id="newImages"
            name="newImages"
            class="form-control"
            multiple
            accept="image/*"
          />
          <small class="text-muted"
            >You can upload multiple images at once (JPG, PNG, GIF).</small
          >
        </div>

        <!-- Content -->
        <div class="mb-4">
          <label for="content" class="form-label fw-semibold">
            <i class="bi bi-text-paragraph me-1"></i> Content
          </label>
          <textarea
            id="content"
            name="content"
            class="form-control"
            rows="8"
            placeholder="Write something engaging..."
            required
          ><%= post.content %></textarea>
        </div>

        <!-- Status -->
        <div class="mb-4">
          <label for="status" class="form-label fw-semibold">
            <i class="bi bi-flag me-1"></i> Status
          </label>
          <select
            id="status"
            name="status"
            class="form-select form-select-lg"
          >
            <option
              value="published"
              <%= post.status === 'published' ? 'selected' : '' %>
            >
              ‚úÖ Published
            </option>
            <option
              value="draft"
              <%= post.status === 'draft' ? 'selected' : '' %>
            >
              üìù Draft
            </option>
            <option
              value="pending"
              <%= post.status === 'pending' ? 'selected' : '' %>
            >
              ‚è≥ Pending
            </option>
          </select>
        </div>

        <!-- Submit -->
        <div class="text-end">
          <button
            type="submit"
            class="btn btn-primary btn-lg px-4 rounded-pill shadow-sm"
          >
            <i class="bi bi-save me-2"></i> Update Post
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

